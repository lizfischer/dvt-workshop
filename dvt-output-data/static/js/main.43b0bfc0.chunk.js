(window.webpackJsonpviz=window.webpackJsonpviz||[]).push([[0],{16:function(e,t,a){e.exports=a(30)},21:function(e,t,a){},22:function(e,t,a){},30:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),s=a(2),r=a.n(s),l=(a(21),a(4)),o=a(9),c=a(10),m=a(11),d=a(14),u=a(12),h=a(15),g=a(7);a(22);function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(a,!0).forEach((function(t){Object(o.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){return("0".repeat(t)+e).toString().substr(-t,t)}var y=["Objects and Faces","Optical Flow","Spectrogram","Audio Tone"],_=["display","flow","spec","tone"];function b(e){var t=i.a.createElement("ul",{className:e.metaFlag?"ul-show":"ul-hide"},e.values.map((function(t,a){return i.a.createElement("li",{key:a},e.titles[a],": ",i.a.createElement("span",null,t))})));return i.a.createElement("div",{className:"grid-item-meta"},i.a.createElement("h3",null,"Detected Metadata"),t)}function E(e){return i.a.createElement("div",{className:"grid-item-desc"},i.a.createElement("h2",null,"Distant Viewing Visualization"),i.a.createElement("p",null,"Welcome to the visualization platform, as part of the ",i.a.createElement("a",{href:"https://github.com/distant-viewing/dvt",target:"_blank",rel:"noopener noreferrer"},"Distant Viewing Toolkit"),". Select a video file, choose desired annotations, and scroll through each video file using the controls on the right-hand side. Hover over an image to see extracted metadata and click to open a larger view."))}function x(e){return i.a.createElement("input",{className:"controls-slider",onChange:e.onChange,type:"range",defaultValue:"0",id:"sliderInput",max:e.length-e.numthumbs})}function O(e){return i.a.createElement("button",{type:"button",onClick:e.onClick,disabled:e.disabled},e.symbol)}var w=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(u.a)(t).call(this,e))).handleVideoChange=function(e){a.setState({video:e.value,video_name:e.label},(function(){a.resetVideo()}))},a.handleTypeChange=function(e){a.setState({img_type:e.value,img_type_name:e.label})},a.state={toc:null,data:null,video:null,video_name:null,num_thumbs:2,img_type:"display",img_type_name:"Objects and Faces",start_index:0,meta_index:0,meta_flag:!1,overlay_index:-1,overlay_type:"frames"},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("./data/toc.json").then((function(e){return e.json()})).then((function(t){e.setState({toc:t,video:t[0].video_name,video_name:t[0].video_name_long},(function(){e.resetVideo()}))}))}},{key:"formatedTimes",value:function(e,t){return function(e){var t=Math.floor(e),a=Math.floor(t/60),n=t%60,i=a%60;return p(Math.floor(a/60),2)+":"+p(i,2)+":"+p(n,2)}(this.state.data.cut[e][t]/this.state.data.meta[0].fps)}},{key:"imgPath",value:function(e,t){if(e<0)return null;var a=this.state.data.cut[e].mpoint;return"spec"===t|"tone"===t&&(a=e),"img/"+this.state.video+"/"+t+"/frame-"+p(a,6)+".png"}},{key:"resetVideo",value:function(){var e=this;fetch("./data/"+this.state.video+".json").then((function(e){return e.json()})).then((function(t){e.setState({data:t,start_index:0,meta_index:0,meta_flag:!1,num_thumbs:Math.min(5,t.cut.length),overlay_index:-1},(function(){}))}))}},{key:"handleIncrementStart",value:function(e){var t=this.state.start_index+e;t<0&&(t=0),t>=this.state.data.cut.length-this.state.num_thumbs+1&&(t=this.state.data.cut.length-this.state.num_thumbs),document.getElementById("sliderInput").value=t,this.setState({start_index:t})}},{key:"handleMetadataId",value:function(e){this.setState({meta_index:e,meta_flag:!0})}},{key:"handleMetadataFlag",value:function(e){this.setState({meta_flag:e})}},{key:"handleOverlay",value:function(e,t){null===t&&(t=this.state.overlay_type),this.setState({overlay_index:e,overlay_type:t})}},{key:"handleSliderSelection",value:function(){var e=document.getElementById("sliderInput");this.setState({start_index:Number(e.value)})}},{key:"render",value:function(){var e=this;if(!this.state.data)return i.a.createElement("span",null,"Waiting...");var t=[],a=0;for(a=0;a<this.state.toc.length;a++)t.push({value:this.state.toc[a].video_name,label:this.state.toc[a].video_name_long});var n=[];for(a=0;a<_.length;a++)a<2|"power"in this.state.data&&n.push({value:_[a],label:y[a]});var s={control:function(e){return f({},e,{minHeight:20})},dropdownIndicator:function(e){return f({},e,{paddingTop:0,paddingBottom:0})},clearIndicator:function(e){return f({},e,{paddingTop:0,paddingBottom:0})}},r=this.state.overlay_index===this.state.data.cut.length-1?" inactive":"",o=0===this.state.overlay_index?" inactive":"";return i.a.createElement("div",{className:"grid-container"},i.a.createElement("div",{className:"grid-item-controls"},i.a.createElement(g.a,{value:{value:this.state.video,label:this.state.video_name},options:t,onChange:this.handleVideoChange,className:"video-select",styles:s}),i.a.createElement(g.a,{value:{value:this.state.img_type,label:this.state.img_type_name},options:n,onChange:this.handleTypeChange,className:"type-select",styles:s}),i.a.createElement(x,{length:this.state.data.cut.length,numthumbs:this.state.num_thumbs,onChange:function(){return e.handleSliderSelection()}}),i.a.createElement(O,{symbol:"\u2190",onClick:function(){return e.handleIncrementStart(-1)},disabled:this.state.start_index<=0}),i.a.createElement(O,{symbol:"\u2192",onClick:function(){return e.handleIncrementStart(1)},disabled:this.state.start_index>=this.state.data.cut.length-this.state.num_thumbs})),i.a.createElement(b,{values:[this.state.meta_index,this.formatedTimes(this.state.meta_index,"frame_start"),this.formatedTimes(this.state.meta_index,"frame_end"),this.state.data.length[this.state.meta_index].num_faces,this.state.data.length[this.state.meta_index].num_people,this.state.data.length[this.state.meta_index].shot_length,this.state.data.length[this.state.meta_index].objects],titles:["Shot Number","Start Time","End Time","Number of Detected Faces","Number of Detected People","Estimated Shot Length","Detected Objects"],metaFlag:this.state.meta_flag}),i.a.createElement(E,null),i.a.createElement("div",{className:"grid-frames-cols"},i.a.createElement("div",null),Object(l.a)(Array(this.state.num_thumbs).keys()).map((function(t){return i.a.createElement("div",{className:"grid-frame-item-col",key:t},e.formatedTimes(e.state.start_index+t,"mpoint"))}))),i.a.createElement("div",{className:"grid-item-frames-orig"},i.a.createElement("div",{className:"grid-frame-item-row"},i.a.createElement("span",{className:"grid-frame-item-row-rot"},"Original")),Object(l.a)(Array(this.state.num_thumbs).keys()).map((function(t){return i.a.createElement("div",{className:"grid-frame-item",key:t,onClick:function(){return e.handleOverlay(e.state.start_index+t,"frames")}},i.a.createElement("img",{src:e.imgPath(e.state.start_index+t,"thumb"),onMouseOver:function(){return e.handleMetadataId(e.state.start_index+t)},onMouseOut:function(){return e.handleMetadataFlag(!1)},tabIndex:"-1",alt:"",draggable:"false",className:"img-thumb"}),i.a.createElement("img",{className:"svg-open",src:"static/eye.svg",width:"20",height:"20",alt:""}))}))),i.a.createElement("div",{className:"grid-item-frames-anno"},i.a.createElement("div",{className:"grid-frame-item-row"},i.a.createElement("span",{className:"grid-frame-item-row-rot"},this.state.img_type_name)),Object(l.a)(Array(this.state.num_thumbs).keys()).map((function(t){return i.a.createElement("div",{className:"grid-frame-item",key:t,onClick:function(){return e.handleOverlay(e.state.start_index+t,e.state.img_type)}},i.a.createElement("img",{src:e.imgPath(e.state.start_index+t,e.state.img_type),onMouseOver:function(){return e.handleMetadataId(e.state.start_index+t)},onMouseOut:function(){return e.handleMetadataFlag(!1)},tabIndex:"-1",alt:"",draggable:"false",className:"img-thumb"}),i.a.createElement("img",{className:"svg-open",src:"static/eye.svg",width:"20",height:"20",alt:""}))}))),i.a.createElement("div",{className:"grid-item-overlay"+(this.state.overlay_index>=0?" visible":"")},i.a.createElement("img",{src:this.imgPath(this.state.overlay_index,this.state.overlay_type),className:"overlay-img",tabIndex:"-1",alt:"",draggable:"false"}),i.a.createElement("img",{className:"svg-icon svg-close",onClick:function(){return e.handleOverlay(-1,null)},src:"static/close.svg",width:"45",height:"45",alt:""}),i.a.createElement("img",{className:"svg-icon svg-next "+r,onClick:function(){return e.handleOverlay(e.state.overlay_index+1,null)},src:"static/next.svg",width:"45",height:"45",alt:""}),i.a.createElement("img",{className:"svg-icon svg-prev "+o,onClick:function(){return e.handleOverlay(e.state.overlay_index-1,null)},src:"static/prev.svg",width:"45",height:"45",alt:""})))}}]),t}(i.a.Component);var k=function(){return i.a.createElement(w,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[16,1,2]]]);
//# sourceMappingURL=main.43b0bfc0.chunk.js.map